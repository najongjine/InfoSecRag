[전체 문서 개요]
제목: 해킹진단도구 활용 방안 #4: 노출된 SMB 파일 서버를 통한 AD 환경 장악
작성: 한국인터넷진흥원(KISA) 위협분석단 포렌식분석팀
설명: 보안 인력이 부족한 중소기업을 대상으로, SMB 취약점을 통한 내부 침투 및 Active Directory(AD) 권한 장악 시나리오를 분석하고 해킹진단도구를 활용한 탐지 및 대응 방안을 제시함.
분석 대상: 파일 서버(Ubuntu 20.04 LTS), 도메인 컨트롤러(Windows Server 2019)

==================================================

[1. 해킹진단도구 개요 및 목적]
핵심 요약: 중소기업이 침해사고의 최종 피해 발생 전 해킹 시도를 스스로 식별하고 대응할 수 있도록 지원하는 자가진단 도구 활용 가이드.
상세 내용: 해킹진단도구는 보안 전담 인력과 예산이 부족한 기업들이 침해사고를 조기에 인지할 수 있도록 개발되었습니다. 자가진단 -> 조기 식별 -> 피해 최소화의 선순환 구조를 만드는 것이 주 목적입니다.

--------------------------------------------------

[2. 침해사고 공격 시나리오 상세]
핵심 요약: SMB 공유 폴더의 접근 제어 미흡을 이용한 초기 침투부터 AD 서버 장악까지의 단계별 공격 흐름.
상세 내용: 공격 흐름: 포트 스캐닝(취약 파일 서버 식별) -> SMB 공유 접근(계정 정보 획득) -> rlogin 원격 접속 -> 악성 코드(Plague) 배포 및 백도어 설치 -> 내부망 이동(Lateral Movement) -> DC 서버 Brute Force 공격 -> RDP 접속 및 관리자 계정 생성 -> PowerShell을 이용한 보안 설정(UAC 등) 해제 -> 흔적 제거.

--------------------------------------------------

[3. 파일 서버(Linux) 탐지 및 대응]
핵심 요약: 리눅스 기반 파일 서버에서 발견된 악성코드 동작, 원격 명령어 사용, 계정 생성 및 데이터 유출 흔적 탐지.
상세 내용: 주요 탐지 항목:
- [PLAGUE]_01: Plague 악성코드 바이너리 값 확인 및 ld.so.preload 삽입 탐지.
- [PS]_03: rlogin, rexec 등 원격 명령 서비스 동작 확인.
- [EVT]_01: 리눅스 로그 내 비정상 계정 생성 확인.
- [EVT]_02: 공격 은닉을 위한 파일 삭제 행위 탐지.
- [EVT]_05: scp, wget 등을 이용한 데이터 유출 도구 실행 확인.

--------------------------------------------------

[4. 도메인 컨트롤러(Windows) 탐지 및 대응]
핵심 요약: 윈도우 서버 환경에서의 비정상 관리자 계정 생성, 백신 기능 무력화 및 권한 상승 탐지.
상세 내용: 주요 탐지 항목:
- [EVT]_09: 비정상적으로 생성된 사용자(관리자) 계정 탐지.
- [EVT]_14: Windows Defender 실시간 감시 기능 비활성화 탐지.
- [EVT]_07: 공격 은닉을 위한 계정 삭제 행위 탐지.
- [REG]_04: UAC(사용자 계정 컨트롤) 경고 기능 꺼짐(EnableLUA=0) 탐지.

--------------------------------------------------

[5. 도구 지원 범위 및 실행 방법]
핵심 요약: 지원하는 운영체제(Windows Server 2008~2025, 주요 리눅스 배포판) 목록 및 아키텍처별 설치 가이드.
상세 내용: 지원 환경: Windows Server 전 버전, Ubuntu, CentOS, RedHat, Rocky, Oracle, Amazon Linux 등 주요 리눅스. 실행 방식: 포터블 실행파일 형태로 제공되며 32/64비트 아키텍처에 맞는 파일을 선택하여 실행.

--------------------------------------------------

